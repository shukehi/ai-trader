#!/usr/bin/env python3
"""
ETHæ°¸ç»­åˆçº¦AIåˆ†æåŠ©æ‰‹ - äº¤æ˜“ä¿¡å·å¯¼å‘æç¤ºæ¨¡æ¿
ä¸“ä¸ºä¸ªäººäº¤æ˜“è€…è®¾è®¡ï¼Œæä¾›å…·ä½“çš„å…¥åœº/å‡ºåœºä»·æ ¼
"""

class TradingPromptTemplates:
    """äº¤æ˜“ä¿¡å·å¯¼å‘çš„æç¤ºæ¨¡æ¿"""
    
    @staticmethod
    def get_trading_signal_prompt() -> str:
        """è·å–äº¤æ˜“ä¿¡å·ä¸“ç”¨æç¤ºï¼ˆAnna Coullingä¸“ä¸šç‰ˆï¼‰"""
        return """ä½ æ˜¯ä¸€ä½ç²¾é€šAnna Coulling Volume Spread Analysis (VSA)ç†è®ºçš„ETHæ°¸ç»­åˆçº¦äº¤æ˜“ä¸“å®¶ã€‚è¯·åŸºäºAnna Coullingçš„VSAç†è®ºæ¡†æ¶å¯¹æ•°æ®è¿›è¡Œä¸“ä¸šåˆ†æï¼Œå¹¶ç»™å‡ºå…·ä½“çš„äº¤æ˜“å»ºè®®ã€‚

## ğŸ¯ **Anna Coulling VSAæ ¸å¿ƒåˆ†ææ¡†æ¶**

### **1. Spread Analysis (ä»·å·®åˆ†æ)**
- **Wide Spread**: é«˜ä½ä»·å·®å¤§ + é«˜æˆäº¤é‡ = ä¸“ä¸šèµ„é‡‘å‚ä¸ï¼Œè¶‹åŠ¿å¼ºåŠ²
- **Narrow Spread**: é«˜ä½ä»·å·®å° = ç¼ºä¹å…´è¶£ï¼Œå¯èƒ½å˜ç›˜
- åˆ†ææ¯æ ¹Kçº¿çš„ä»·å·®ä¸æˆäº¤é‡å…³ç³»

### **2. Close Position Analysis (æ”¶ç›˜ä½ç½®åˆ†æ)** 
- **High Close (0.7-1.0)**: æ”¶ç›˜ä»·æ¥è¿‘æœ€é«˜ä»· = å¼ºåŠ¿
- **Mid Close (0.3-0.7)**: æ”¶ç›˜ä»·å±…ä¸­ = ä¸­æ€§
- **Low Close (0-0.3)**: æ”¶ç›˜ä»·æ¥è¿‘æœ€ä½ä»· = å¼±åŠ¿
- è®¡ç®—å…¬å¼ï¼š(æ”¶ç›˜ä»·-æœ€ä½ä»·)/(æœ€é«˜ä»·-æœ€ä½ä»·)

### **3. Volume Analysis (æˆäº¤é‡åˆ†æ)**
- **åŠªåŠ› vs ç»“æœ**: æˆäº¤é‡(åŠªåŠ›) ä¸ ä»·æ ¼å˜åŠ¨(ç»“æœ) æ˜¯å¦åŒ¹é…
- **Volume Dry Up**: æˆäº¤é‡èç¼©é¢„ç¤ºå˜ç›˜
- **Climax Volume**: å¼‚å¸¸æ”¾é‡é€šå¸¸æ ‡å¿—è¶‹åŠ¿å°¾å£°

### **4. Professional Money Signals (ä¸“ä¸šèµ„é‡‘ä¿¡å·)**
- **No Demand**: ä¸Šæ¶¨ + ç¼©é‡ = ç¼ºä¹ä¹°ç›˜ï¼Œçœ‹ç©ºä¿¡å·
- **No Supply**: ä¸‹è·Œ + ç¼©é‡ = ç¼ºä¹å–ç›˜ï¼Œçœ‹å¤šä¿¡å·  
- **Upthrust**: çªç ´æ–°é«˜åå¿«é€Ÿå›è½ = å‡çªç ´ï¼Œåˆ†é…ä¿¡å·
- **Spring**: è·Œç ´æ”¯æ’‘åå¿«é€Ÿå›å‡ = å‡è·Œç ´ï¼Œç§¯ç´¯ä¿¡å·
- **Climax**: æç«¯æ”¾é‡é…åˆä»·æ ¼å¤§å¹…å˜åŠ¨ = è¶‹åŠ¿åè½¬ä¿¡å·

### **5. Wyckoff Market Phases (å¸‚åœºé˜¶æ®µ)**
- **Accumulation (ç§¯ç´¯)**: æ¨ªç›˜æ•´ç†ï¼Œä¸“ä¸šèµ„é‡‘æ‚„æ‚„å¸ç­¹
- **Markup (ä¸Šå‡)**: è¶‹åŠ¿ä¸Šæ¶¨ï¼Œæˆäº¤é‡æŒç»­é…åˆ
- **Distribution (åˆ†é…)**: é«˜ä½æ¨ªç›˜ï¼Œä¸“ä¸šèµ„é‡‘å‡ºè´§
- **Markdown (ä¸‹é™)**: è¶‹åŠ¿ä¸‹è·Œï¼Œææ…Œæ€§æŠ›å”®

### **6. Smart Money vs Dumb Money**
- **Smart Money**: åœ¨ä½ä½ä¹°å…¥ï¼Œé«˜ä½å–å‡ºï¼Œåå¤§ä¼—æƒ…ç»ª
- **Dumb Money**: è¿½æ¶¨æ€è·Œï¼Œè¢«æƒ…ç»ªé©±åŠ¨
- **æ°¸ç»­åˆçº¦ç‰¹æ€§**: æ æ†æ”¾å¤§æ•£æˆ·æƒ…ç»ªï¼Œèµ„é‡‘è´¹ç‡åæ˜ æƒ…ç»ªæç«¯

## ğŸ¯ **MANDATORY: VSAä¸“ä¸šæœ¯è¯­æ ‡å‡†åŒ–**
**CRITICAL**: å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ç²¾ç¡®çš„Anna Coulling VSAæœ¯è¯­ï¼Œä¸å¾—éšæ„æ›¿æ¢ï¼š

**ä¸“ä¸šä¿¡å·æœ¯è¯­**ï¼š
- "No Demand" (ä¸èƒ½ç”¨"ç¼ºä¹éœ€æ±‚"ã€"ä¹°ç›˜ä¸è¶³"ç­‰æ›¿ä»£)
- "No Supply" (ä¸èƒ½ç”¨"ç¼ºä¹ä¾›åº”"ã€"å–ç›˜ä¸è¶³"ç­‰æ›¿ä»£)  
- "Climax Volume" (ä¸èƒ½ç”¨"å¼‚å¸¸æ”¾é‡"ã€"é«˜æ½®æˆäº¤é‡"ç­‰æ›¿ä»£)
- "Upthrust" (ä¸èƒ½ç”¨"å‡çªç ´"ã€"è¯±å¤š"ç­‰æ›¿ä»£)
- "Spring" (ä¸èƒ½ç”¨"å‡è·Œç ´"ã€"è¯±ç©º"ç­‰æ›¿ä»£)
- "Wide Spread" / "Narrow Spread" (ä¿æŒè‹±æ–‡ä¸“ä¸šæ€§)

**å¸‚åœºé˜¶æ®µæœ¯è¯­**ï¼š
- "Accumulation" (ç§¯ç´¯é˜¶æ®µï¼Œä¸»åŠ›å»ºä»“)
- "Markup" (æ ‡è®°é˜¶æ®µï¼Œè¶‹åŠ¿ä¸Šæ¶¨)  
- "Distribution" (æ´¾å‘é˜¶æ®µï¼Œä¸»åŠ›å‡ºè´§)
- "Markdown" (é™ä»·é˜¶æ®µï¼Œè¶‹åŠ¿ä¸‹è·Œ)

**ä¸“ä¸šèµ„é‡‘æœ¯è¯­**ï¼š
- "Smart Money" / "Professional Money" (ä¸“ä¸šèµ„é‡‘)
- "Selling Pressure" / "Buying Pressure" (æ˜ç¡®çš„ä¹°å–å‹åŠ›)
- "Effort vs Result" (åŠªåŠ›ä¸ç»“æœçš„å…³ç³»åˆ†æ)

## ğŸ“‹ **åˆ†æè¦æ±‚ä¸è¾“å‡ºæ ¼å¼**

**å¿…é¡»åŒ…å«ä»¥ä¸‹VSAåˆ†æ (Anna Coullingæ ‡å‡†)**ï¼š
1. æ¯æ ¹å…³é”®Kçº¿çš„Spread Analysis (Wide/Narrow) + Close Positionè¯„åˆ† (High/Mid/Low)
2. è¯†åˆ«No Demand/No Supply/Climax Volumeç­‰ä¸“ä¸šä¿¡å· (ä½¿ç”¨ç²¾ç¡®æœ¯è¯­)
3. åˆ¤æ–­å½“å‰Wyckoffå¸‚åœºé˜¶æ®µ (Accumulation/Markup/Distribution/Markdown)
4. Smart Money vs Dumb Moneyè¡Œä¸ºåˆ†æ (å…·ä½“æè¿°èµ„é‡‘æµå‘)
5. Effort vs Resultåˆ†æ (æˆäº¤é‡ä¸ä»·æ ¼å˜åŠ¨çš„åŒ¹é…åº¦)
6. åŸºäºVSAç†è®ºçš„å…·ä½“äº¤æ˜“è®¡åˆ’ (å…¥åœº/æ­¢æŸ/ç›®æ ‡ä»·æ ¼)

**åˆ†æè´¨é‡æ ‡å‡†**ï¼š
- è‡³å°‘ä½¿ç”¨5ä¸ªAnna Coullingä¸“ä¸šVSAæœ¯è¯­
- æ¯ä¸ªä¿¡å·å¿…é¡»æœ‰å…·ä½“çš„Kçº¿å’Œæˆäº¤é‡æ•°æ®æ”¯æŒ
- å¿…é¡»è§£é‡ŠSmart Moneyå’ŒDumb Moneyçš„å…·ä½“è¡Œä¸ºè¡¨ç°

**è¾“å‡ºæ ¼å¼**ï¼š
## ğŸ¯ äº¤æ˜“ä¿¡å·æ€»ç»“ (åŸºäºVSAåˆ†æ)
**ä¿¡å·ç±»å‹**: [åšå¤š/åšç©º/è§‚æœ›]
**ä¿¡å·å¼ºåº¦**: [å¼º/ä¸­/å¼±] (1-10åˆ†: Xåˆ†)  
**Wyckoffé˜¶æ®µ**: [Accumulation/Markup/Distribution/Markdown]
**Smart Moneyè¡Œä¸º**: [å¸ç­¹/å‡ºè´§/æµ‹è¯•/è¯±å¤šè¯±ç©º]

## ğŸ’° å…·ä½“äº¤æ˜“è®¡åˆ’
**å…¥åœºä»·æ ¼**: $XXX.XX - $XXX.XX  
**æ­¢æŸä»·æ ¼**: $XXX.XX (é£é™©: X.X%)
**ç›®æ ‡ä»·æ ¼1**: $XXX.XX (æ”¶ç›Š: X.X%)
**ç›®æ ‡ä»·æ ¼2**: $XXX.XX (æ”¶ç›Š: X.X%)
**å»ºè®®ä»“ä½**: 2-5% èµ„é‡‘ (Anna Coullingé£é™©ç®¡ç†ï¼šå•ç¬”äº¤æ˜“ä¸è¶…è¿‡æ€»èµ„é‡‘5%)

## ğŸ“Š ä¸“ä¸šVSAåˆ†æ
**å…³é”®Kçº¿Spreadåˆ†æ**: [Wide/Narrow] + Close Positionè¯„åˆ†
**Volume Pattern**: [æ”¾é‡/ç¼©é‡/æ­£å¸¸] ä¸ä»·æ ¼å˜åŠ¨çš„åŒ¹é…åº¦
**Professional Signals**: [No Demand/No Supply/Climax/Upthrust/Spring]
**Smart Moneyç—•è¿¹**: [å…·ä½“æè¿°ä¸“ä¸šèµ„é‡‘è¡Œä¸º]

## âš¡ å…³é”®æ”¯æ’‘é˜»åŠ› (VSAç¡®è®¤)
**VSAæ”¯æ’‘**: $XXX.XX (åŸºäº[å…·ä½“VSAä¿¡å·])
**VSAé˜»åŠ›**: $XXX.XX (åŸºäº[å…·ä½“VSAä¿¡å·])  
**çªç ´ç¡®è®¤**: éœ€é…åˆ[æˆäº¤é‡/Spread]ç¡®è®¤

## âš ï¸ é£é™©æ§åˆ¶ (Anna Coullingé£æ ¼)
**æœ€å¤§é£é™©**: ä¸è¶…è¿‡2% (Anna Coullingé£é™©ç®¡ç†åŸåˆ™)
**æ­¢æŸæ¡ä»¶**: [å…·ä½“VSAä¿¡å·å¤±æ•ˆæ¡ä»¶]
**æ³¨æ„ä¿¡å·**: [å¯èƒ½çš„VSAå‡ä¿¡å·æˆ–é™·é˜±]

## ğŸ“Š **CRITICAL: å¿…é¡»è¾“å‡ºç½®ä¿¡åº¦**
**IMPORTANT**: åœ¨åˆ†æç»“æŸæ—¶ï¼Œå¿…é¡»åŒ…å«ä»¥ä¸‹æ ¼å¼çš„ç½®ä¿¡åº¦è¯„ä¼°ï¼š
**ç½®ä¿¡åº¦**: XX% (æ•°å­—å¿…é¡»åœ¨0-100ä¹‹é—´)
**ç½®ä¿¡ç†ç”±**: [ç®€è¦è¯´æ˜ç½®ä¿¡åº¦è¯„çº§çš„ä¾æ®]

ç°åœ¨è¯·åŸºäºAnna Coullingçš„VSAç†è®ºåˆ†æä»¥ä¸‹æ•°æ®ï¼š"""

    @staticmethod
    def get_research_analysis_prompt() -> str:
        """è·å–æ·±åº¦ç ”ç©¶åˆ†ææç¤ºï¼ˆå®Œæ•´ç‰ˆï¼‰"""
        return """ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ETHæ°¸ç»­åˆçº¦åˆ†æå¸ˆï¼Œç²¾é€šVolume Price Analysis (VPA)å’ŒVolume Spread Analysis (VSA)ã€‚è¯·åŸºäºAnna Coullingçš„VSAç†è®ºå’Œæ°¸ç»­åˆçº¦ç‰¹æ€§ï¼Œå¯¹æä¾›çš„æ•°æ®è¿›è¡Œæ·±åº¦åˆ†æã€‚

**åˆ†ææ¡†æ¶**ï¼š
1. **å¸‚åœºé˜¶æ®µè¯†åˆ«**: æ ¹æ®Wyckoffç†è®ºåˆ¤æ–­å½“å‰å¤„äºç§¯ç´¯ã€ä¸Šå‡ã€åˆ†é…æˆ–ä¸‹é™é˜¶æ®µ
2. **VSAæ ¸å¿ƒåˆ†æ**: åˆ†æä»·å·®å®½çª„ã€æ”¶ç›˜ä½ç½®ã€æˆäº¤é‡æ¯”ç‡ã€ä¸“ä¸šèµ„é‡‘æ´»åŠ¨
3. **æ°¸ç»­åˆçº¦å› å­**: èµ„é‡‘è´¹ç‡ã€æŒä»“é‡ã€æ æ†æ•ˆåº”å¯¹ä»·æ ¼çš„å½±å“
4. **å¤šæ—¶é—´æ¡†æ¶**: ç»“åˆ1æ—¥ã€4å°æ—¶ã€1å°æ—¶ã€15åˆ†é’Ÿçš„ä¿¡å·ä¸€è‡´æ€§
5. **Smart Moneyæ£€æµ‹**: è¯†åˆ«æ— éœ€æ±‚ã€æ— ä¾›åº”ã€é«˜æ½®æˆäº¤é‡ã€å‡çªç ´ã€å¼¹ç°§ç­‰ä¿¡å·

**é‡ç‚¹å…³æ³¨**ï¼š
- No Demand (æ— éœ€æ±‚): ä¸Šæ¶¨æ—¶æˆäº¤é‡å‡å°‘
- No Supply (æ— ä¾›åº”): ä¸‹è·Œæ—¶æˆäº¤é‡å‡å°‘  
- Climax Volume (é«˜æ½®æˆäº¤é‡): å¼‚å¸¸æ”¾é‡çš„åè½¬ä¿¡å·
- Wide/Narrow Spread: ä»·å·®åˆ†æåæ˜ ä¸“ä¸šèµ„é‡‘å‚ä¸åº¦
- æ°¸ç»­åˆçº¦èµ„é‡‘è´¹ç‡çš„æƒ…ç»ªæŒ‡ç¤ºä½œç”¨

## ğŸ“Š **CRITICAL: å¿…é¡»è¾“å‡ºç½®ä¿¡åº¦**
**MANDATORY**: åˆ†æç»“æŸæ—¶å¿…é¡»åŒ…å«ï¼š
**ç½®ä¿¡åº¦**: XX% (0-100çš„æ•°å­—)
**ç½®ä¿¡ä¾æ®**: [è¯´æ˜æ­¤ç½®ä¿¡åº¦çš„ç†ç”±ï¼ŒåŒ…æ‹¬æ”¯æŒå’Œåå¯¹å› ç´ ]

ç°åœ¨è¯·åˆ†æä»¥ä¸‹æ•°æ®ï¼š"""

    @staticmethod
    def get_quick_signal_prompt() -> str:
        """å¿«é€Ÿä¿¡å·æ£€æŸ¥æç¤ºï¼ˆè¶…ç®€åŒ–ç‰ˆï¼‰"""
        return """åŸºäºæ•°æ®å¿«é€Ÿç»™å‡ºäº¤æ˜“ä¿¡å·ï¼š

æ ¼å¼è¦æ±‚ï¼š
**ä¿¡å·**: [åšå¤š/åšç©º/è§‚æœ›] 
**å…¥åœº**: $XXX
**æ­¢æŸ**: $XXX  
**ç›®æ ‡**: $XXX
**ç†ç”±**: [ä¸€å¥è¯è¯´æ˜]
**ç½®ä¿¡åº¦**: XX% (å¿…é¡»æä¾›0-100çš„æ•°å­—)

æ•°æ®ï¼š"""

    @staticmethod
    def get_executive_summary_prompt() -> str:
        """æ‰§è¡Œæ‘˜è¦æç¤ºï¼ˆç®¡ç†å±‚ç®€æŠ¥æ ¼å¼ï¼‰"""
        return """è¯·æä¾›æ‰§è¡Œæ‘˜è¦æ ¼å¼çš„ETHåˆ†ææŠ¥å‘Šï¼š

## Executive Summary
**Signal**: [BUY/SELL/HOLD]
**Entry**: $XXX.XX
**Stop**: $XXX.XX  
**Target**: $XXX.XX
**Risk/Reward**: 1:X
**Confidence**: X/10

## Key Points
- [è¦ç‚¹1]
- [è¦ç‚¹2] 
- [è¦ç‚¹3]

## Action Required
[å…·ä½“è¡ŒåŠ¨å»ºè®®]

æ•°æ®ï¼š"""

class TradingModeSelector:
    """äº¤æ˜“æ¨¡å¼é€‰æ‹©å™¨"""
    
    MODES = {
        'signal': {
            'name': 'äº¤æ˜“ä¿¡å·æ¨¡å¼',
            'prompt': TradingPromptTemplates.get_trading_signal_prompt(),
            'description': 'æä¾›å…·ä½“å…¥åœº/å‡ºåœºä»·æ ¼çš„å®ç”¨äº¤æ˜“ä¿¡å·',
            'cost_level': 'medium',
            'response_time': '30-60s'
        },
        'research': {
            'name': 'æ·±åº¦ç ”ç©¶æ¨¡å¼', 
            'prompt': TradingPromptTemplates.get_research_analysis_prompt(),
            'description': 'åŸºäºVSAç†è®ºçš„å®Œæ•´æŠ€æœ¯åˆ†ææŠ¥å‘Š',
            'cost_level': 'high',
            'response_time': '60-120s'
        },
        'quick': {
            'name': 'å¿«é€Ÿä¿¡å·æ¨¡å¼',
            'prompt': TradingPromptTemplates.get_quick_signal_prompt(), 
            'description': '30ç§’å†…ç»™å‡ºç®€æ˜äº¤æ˜“å»ºè®®',
            'cost_level': 'low',
            'response_time': '10-30s'
        },
        'executive': {
            'name': 'æ‰§è¡Œæ‘˜è¦æ¨¡å¼',
            'prompt': TradingPromptTemplates.get_executive_summary_prompt(),
            'description': 'ç®¡ç†å±‚ç®€æŠ¥æ ¼å¼çš„æ ¸å¿ƒè¦ç‚¹',
            'cost_level': 'low',
            'response_time': '15-45s'
        }
    }
    
    @classmethod
    def get_mode(cls, mode_name: str) -> dict:
        """è·å–æŒ‡å®šæ¨¡å¼"""
        return cls.MODES.get(mode_name, cls.MODES['signal'])
    
    @classmethod
    def list_modes(cls) -> dict:
        """åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¨¡å¼"""
        return {k: {
            'name': v['name'],
            'description': v['description'],
            'cost_level': v['cost_level'],
            'response_time': v['response_time']
        } for k, v in cls.MODES.items()}

def get_recommended_mode(user_preference: str = 'trader') -> str:
    """æ ¹æ®ç”¨æˆ·åå¥½æ¨èæ¨¡å¼"""
    preferences = {
        'trader': 'signal',      # ä¸ªäººäº¤æ˜“è€… -> äº¤æ˜“ä¿¡å·æ¨¡å¼
        'researcher': 'research', # ç ”ç©¶äººå‘˜ -> æ·±åº¦ç ”ç©¶æ¨¡å¼  
        'quick': 'quick',        # å¿«é€Ÿå†³ç­– -> å¿«é€Ÿä¿¡å·æ¨¡å¼
        'manager': 'executive'   # ç®¡ç†å±‚ -> æ‰§è¡Œæ‘˜è¦æ¨¡å¼
    }
    return preferences.get(user_preference, 'signal')