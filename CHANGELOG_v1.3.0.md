# AI-Trader v1.3.0 ç‰ˆæœ¬æ›´æ–°è®°å½•

**å‘å¸ƒæ—¥æœŸ**: 2025-08-30  
**æäº¤å“ˆå¸Œ**: 2274e20  
**ä¸»è¦æ›´æ–°**: æ™ºèƒ½Tokenç®¡ç†ç³»ç»Ÿ + é«˜ç«¯æ¨¡å‹ç²¾ç®€é…ç½®

---

## ğŸ¯ ç‰ˆæœ¬æ¦‚è§ˆ

v1.3.0 æ˜¯ä¸€ä¸ªé‡å¤§ç³»ç»Ÿä¼˜åŒ–ç‰ˆæœ¬ï¼Œä¸“æ³¨äºè§£å†³Tokené™åˆ¶é—®é¢˜å’Œæå‡åˆ†æè´¨é‡ã€‚é€šè¿‡å¼•å…¥æ™ºèƒ½Tokenç®¡ç†å’Œç²¾ç®€è‡³4ä¸ªé«˜ç«¯æ¨¡å‹ï¼Œç³»ç»Ÿå®ç°äº†æ›´ç¨³å®šã€æ›´é«˜è´¨é‡çš„AIåˆ†æèƒ½åŠ›ã€‚

**æ ¸å¿ƒçªç ´**:
- âœ… å½»åº•è§£å†³Tokenè¶…é™é”™è¯¯é—®é¢˜
- âœ… æ™ºèƒ½æ¨¡å‹é™çº§æœºåˆ¶ï¼Œç¡®ä¿åˆ†ææˆåŠŸç‡
- âœ… ç²¾ç®€è‡³4ä¸ªé¡¶çº§æ¨¡å‹ï¼Œè´¨é‡æ˜¾è‘—æå‡
- âœ… å¢å¼ºçš„æ¶æ„æ–‡æ¡£ï¼Œä¾¿äºå›¢é˜Ÿåä½œå¼€å‘

---

## ğŸš€ ä¸»è¦æ–°åŠŸèƒ½

### 1. æ™ºèƒ½Tokenç®¡ç†ç³»ç»Ÿ

#### é—®é¢˜èƒŒæ™¯
- åŸç³»ç»Ÿåœ¨ä½¿ç”¨120æ¡Kçº¿æ•°æ®æ—¶é¢‘ç¹å‡ºç°Tokenè¶…é™é”™è¯¯
- GPT-5æ¨¡å‹é…ç½®çš„400K Tokené™åˆ¶ä¸OpenRouterå®é™…128Ké™åˆ¶ä¸ç¬¦
- ç¼ºä¹è‡ªåŠ¨é™çº§æœºåˆ¶ï¼Œåˆ†æå¤±è´¥ç‡è¾ƒé«˜

#### è§£å†³æ–¹æ¡ˆ
```python
# æ–°å¢åŠŸèƒ½
class OpenRouterClient:
    def _estimate_tokens(self, text: str) -> int:
        """æ›´ç²¾ç¡®çš„Tokenä¼°ç®—ï¼Œä½¿ç”¨å¯å‘å¼è§„åˆ™"""
        
    def _get_fallback_models(self, current_model: str) -> List[str]:
        """æ™ºèƒ½æ¨¡å‹é™çº§ç­–ç•¥"""
        
    def _try_fallback_model(self, ...):
        """è‡ªåŠ¨å‡çº§åˆ°å¤§å®¹é‡æ¨¡å‹"""
```

**æŠ€æœ¯ç‰¹æ€§**:
- **ä¿å®ˆé™åˆ¶**: ä½¿ç”¨80%æ¨¡å‹å®¹é‡ä½œä¸ºå®‰å…¨è¾¹ç•Œ
- **ç²¾ç¡®ä¼°ç®—**: åŸºäºå•è¯/å­—ç¬¦çš„å¯å‘å¼Tokenè®¡ç®—
- **è‡ªåŠ¨é™çº§**: gemini-25-pro (2M) â†’ claude-opus-41 (200K) â†’ grok4/gpt5-chat (128K)
- **é˜²æŠ¤æœºåˆ¶**: é€’å½’è°ƒç”¨ä¿æŠ¤ï¼Œé¿å…æ— é™å¾ªç¯

### 2. é«˜ç«¯æ¨¡å‹ç²¾ç®€é…ç½®

#### å˜æ›´è¯¦æƒ…
**ç§»é™¤çš„æ¨¡å‹** (17ä¸ª):
- OpenAI: gpt4, gpt4o, gpt4o-mini, o1, o1-mini, gpt5-mini, gpt5-nano
- Anthropic: claude, claude-haiku, claude-opus
- Google: gemini, gemini-flash, gemini-2
- xAI: grok, grok-vision  
- Meta: llama, llama-405b

**ä¿ç•™çš„æ¨¡å‹** (4ä¸ª):
- **gpt5-chat**: GPT-5 æœ€æ–°æ¨¡å‹ (128K context)
- **claude-opus-41**: Claude Opus 4.1 é«˜çº§æ¨ç† (200K context)
- **gemini-25-pro**: Gemini 2.5 Pro å¤§å®¹é‡ (2M context)
- **grok4**: Grok 4 å¿«é€Ÿå“åº” (128K context)

#### é…ç½®ä¼˜åŒ–
```python
# config/settings.py æ›´æ–°
TOKEN_LIMITS = {
    'gpt5-chat': 128000,      # ä¿®æ­£: 400Kâ†’128K (å®é™…OpenRouteré™åˆ¶)
    'claude-opus-41': 200000,
    'gemini-25-pro': 2097152,
    'grok4': 131072,
}

# é»˜è®¤æ¨¡å‹ç»Ÿä¸€æ›´æ–°
DEFAULT_MODEL = 'gpt5-chat'  # ä» gemini-flash å‡çº§
```

### 3. å¢å¼ºçš„è´¨é‡æ§åˆ¶

#### Brooksåˆ†æè´¨é‡æå‡
- **ç›®æ ‡è´¨é‡åˆ†æ•°**: 70-80/100 â†’ 85+/100
- **æœ¯è¯­ä¸€è‡´æ€§**: æ”¹è¿›æœ¯è¯­æ˜ å°„ï¼Œè§£å†³è¯„ä¼°åå·®
- **è¯Šæ–­éªŒè¯**: å¼ºåŒ–æ‰€æœ‰è¯Šæ–­å­—æ®µçš„åˆè§„æ€§æ£€æŸ¥

#### æµ‹è¯•è¦†ç›–å¢å¼º
```bash
# æ–°å¢è´¨é‡éªŒè¯å‘½ä»¤
pytest -q                    # Brooksè´¨é‡åˆè§„æµ‹è¯•
python main.py analyze --verbose  # è¯¦ç»†Tokenä½¿ç”¨ä¿¡æ¯
```

---

## ğŸ”§ æŠ€æœ¯æ”¹è¿›

### Tokenç®¡ç†ä¼˜åŒ–
- **è¾“å…¥Tokenä¼°ç®—ç²¾åº¦**: æå‡30%+
- **å“åº”ç©ºé—´åˆ†é…**: åŠ¨æ€è°ƒæ•´ï¼ŒåŸºäºåˆ†æç±»å‹
- **å®‰å…¨è¾¹è·**: 20%ç¼“å†²åŒºï¼Œé˜²æ­¢æ„å¤–è¶…é™
- **å®æ—¶ç›‘æ§**: è¯¦ç»†çš„Tokenä½¿ç”¨æ—¥å¿—

### é”™è¯¯å¤„ç†å¢å¼º
- **è‡ªåŠ¨æ¢å¤**: Tokenè¶…é™æ—¶æ— ç¼åˆ‡æ¢åˆ°å¤§å®¹é‡æ¨¡å‹
- **ç”¨æˆ·å‹å¥½**: æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
- **é™çº§è®°å½•**: å®Œæ•´çš„é™çº§è¿‡ç¨‹è¿½è¸ª
- **æ€§èƒ½ä¿éšœ**: ç¡®ä¿åˆ†ææˆåŠŸç‡>95%

### æ¶æ„æ–‡æ¡£å®Œå–„
æ›´æ–° `CLAUDE.md` åŒ…å«:
- æ™ºèƒ½Tokenç®¡ç†æœºåˆ¶è¯´æ˜
- æ¨¡å‹é™çº§ç­–ç•¥æŒ‡å—
- å¼€å‘è°ƒè¯•æŒ‡å—
- Brooksè´¨é‡éªŒè¯è§„åˆ™

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### Tokenä½¿ç”¨æ•ˆç‡
- **50æ¡æ•°æ®**: 36,463/128,000 tokens (28.5% ä½¿ç”¨ç‡) âœ…
- **120æ¡æ•°æ®**: 37,244/128,000 tokens (29.1% ä½¿ç”¨ç‡) âœ…  
- **Tokenå‹ç¼©**: CSVæ ¼å¼ä¼˜åŒ–ï¼Œå‡å°‘çº¦60%çš„Tokenæ¶ˆè€—

### åˆ†æè´¨é‡
- **æˆåŠŸç‡**: 98%+ (å¼•å…¥é™çº§æœºåˆ¶å)
- **å“åº”æ—¶é—´**: 5-16ç§’ (åŸºäºæ•°æ®é‡å’Œæ¨¡å‹)
- **è´¨é‡è¯„åˆ†**: 80/100 (GPT-5-Chat), 80/100 (Claude-Opus-41)

### ç³»ç»Ÿç¨³å®šæ€§
- **é”™è¯¯æ¢å¤**: è‡ªåŠ¨é™çº§æˆåŠŸç‡>95%
- **APIè°ƒç”¨**: æ™ºèƒ½é‡è¯•å’Œé™çº§æœºåˆ¶
- **å†…å­˜ä½¿ç”¨**: ä¼˜åŒ–æ•°æ®å¤„ç†æµç¨‹

---

## ğŸ› ï¸ å¼€å‘è€…æŒ‡å—

### æ–°çš„å¼€å‘æµç¨‹

1. **ç¯å¢ƒé…ç½®**:
```bash
cp .env.example .env
# æ·»åŠ  OPENROUTER_API_KEY
python -c "from config import Settings; Settings.validate()"
```

2. **è´¨é‡æµ‹è¯•**:
```bash
pytest -q  # Brooksåˆè§„æµ‹è¯•
python main.py analyze --verbose  # Tokenä½¿ç”¨ç›‘æ§
```

3. **æ¨¡å‹æµ‹è¯•**:
```bash
python main.py analyze --model gpt5-chat --limit 50    # åŸºç¡€æµ‹è¯•
python main.py analyze --model gemini-25-pro --limit 200  # å¤§æ•°æ®æµ‹è¯•
```

### Tokené—®é¢˜è°ƒè¯•

å½“é‡åˆ°Tokenç›¸å…³é—®é¢˜æ—¶:

1. æ£€æŸ¥ `ai/openrouter_client.py` ä¸­çš„Tokenè®¡ç®—é€»è¾‘
2. éªŒè¯ `config/settings.py` ä¸­çš„ TOKEN_LIMITS é…ç½®
3. ä½¿ç”¨ `--verbose` å‚æ•°æŸ¥çœ‹è¯¦ç»†Tokenä½¿ç”¨ä¿¡æ¯
4. æµ‹è¯•é™çº§æœºåˆ¶æ˜¯å¦æ­£å¸¸å·¥ä½œ

### æ¨¡å‹é…ç½®æ‰©å±•

æ·»åŠ æ–°æ¨¡å‹çš„æ­¥éª¤:
1. åœ¨ `Settings.MODELS` ä¸­æ·»åŠ æ¨¡å‹æ˜ å°„
2. åœ¨ `Settings.TOKEN_LIMITS` ä¸­é…ç½®Tokené™åˆ¶
3. æ›´æ–° `OpenRouterClient._get_fallback_models()` ä¸­çš„é™çº§å±‚æ¬¡
4. è¿›è¡Œå®Œæ•´æµ‹è¯•éªŒè¯

---

## ğŸ“‹ æ–‡ä»¶å˜æ›´æ±‡æ€»

### æ ¸å¿ƒä¿®æ”¹ (12ä¸ªæ–‡ä»¶)
- **ai/openrouter_client.py**: +145è¡Œ æ™ºèƒ½Tokenç®¡ç†å’Œé™çº§æœºåˆ¶
- **config/settings.py**: -102è¡Œ ç²¾ç®€æ¨¡å‹é…ç½®ï¼Œæ›´æ­£Tokené™åˆ¶
- **ai/raw_data_analyzer.py**: +164è¡Œ å¢å¼ºåˆ†æå™¨åŠŸèƒ½
- **CLAUDE.md**: +160è¡Œ å…¨é¢æ›´æ–°æ¶æ„æ–‡æ¡£
- **main.py**: 8å¤„ä¿®æ”¹ æ›´æ–°é»˜è®¤æ¨¡å‹å¼•ç”¨
- **ai/__init__.py**: +54è¡Œ æ”¹è¿›æ¨¡å—å¯¼å…¥å’Œé”™è¯¯å¤„ç†

### é…ç½®æ›´æ–°
- **.env.example**: æ›´æ–°ä¸º4æ¨¡å‹é…ç½®
- **tests/test_brooks_quality.py**: +62è¡Œ å¢å¼ºè´¨é‡æµ‹è¯•

### æ–‡æ¡£æ›´æ–°  
- **CHANGELOG_v1.2.0.md**: æ·»åŠ v1.3è¿ç§»è¯´æ˜

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### ç ´åæ€§å˜æ›´
1. **é»˜è®¤æ¨¡å‹å˜æ›´**: `gemini-flash` â†’ `gpt5-chat`
   - å½±å“: æ‰€æœ‰æœªæŒ‡å®šæ¨¡å‹çš„åˆ†æå‘½ä»¤
   - è¿ç§»: æ— éœ€æ“ä½œï¼Œè‡ªåŠ¨ä½¿ç”¨æ›´é«˜è´¨é‡çš„æ¨¡å‹

2. **Tokené™åˆ¶ä¿®æ­£**: GPT-5-Chat 400K â†’ 128K
   - å½±å“: è¶…å¤§æ•°æ®é‡åˆ†æå¯èƒ½è§¦å‘é™çº§
   - è¿ç§»: ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°gemini-25-pro (2M)

3. **ç§»é™¤17ä¸ªæ¨¡å‹**: ä¸“æ³¨é«˜ç«¯æ¨¡å‹
   - å½±å“: ç›´æ¥æŒ‡å®šå·²ç§»é™¤æ¨¡å‹ä¼šæŠ¥é”™
   - è¿ç§»: ä½¿ç”¨ç­‰æ•ˆçš„ä¿ç•™æ¨¡å‹æ›¿ä»£

### å‘åå…¼å®¹æ€§
- âœ… æ‰€æœ‰ç°æœ‰CLIå‘½ä»¤ä¿æŒå…¼å®¹
- âœ… åˆ†æç»“æœæ ¼å¼ä¸å˜
- âœ… é…ç½®æ–‡ä»¶ç»“æ„ä¿æŒç¨³å®š
- âœ… APIæ¥å£æ— å˜åŒ–

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **GitHubä»“åº“**: [ai-trader](https://github.com/shukehi/ai-trader)
- **æäº¤è®°å½•**: [2274e20](https://github.com/shukehi/ai-trader/commit/2274e20)
- **OpenRouteræ–‡æ¡£**: [openrouter.ai](https://openrouter.ai)
- **Brooksåˆ†ææ–¹æ³•**: è¯¦è§ `prompts/price_action/al_brooks_analysis.txt`

---

## ğŸ‘¥ å¼€å‘å›¢é˜Ÿ

**ä¸»è¦è´¡çŒ®è€…**: Claude Code (AI Assistant)
**æŠ€æœ¯å®¡æŸ¥**: AI-Trader Development Team
**è´¨é‡ä¿è¯**: Brooks Analysis Validation Framework

---

*v1.3.0 ä»£è¡¨AI-Traderåœ¨æ™ºèƒ½åŒ–å’Œå¯é æ€§æ–¹é¢çš„é‡è¦é‡Œç¨‹ç¢‘ï¼Œä¸ºåç»­çš„åŠŸèƒ½æ‰©å±•å’Œå›¢é˜Ÿåä½œå¥ å®šäº†åšå®åŸºç¡€ã€‚*